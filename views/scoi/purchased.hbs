{{!-- views/scoi/purchased_redesigned.hbs - MY PURCHASED SCOI REPORTS --}}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>My SCOI Intelligence Reports | CRIPFCnt</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@600;700&family=Work+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --gold:#C9A647;
      --gold-light:#D4B666;
      --navy:#0A1929;
      --navy-light:#1A2937;
      --slate:#475569;
      --white:#FFFFFF;
      --cream:#FAFAF9;
      --gray-100:#F1F5F9;
      --gray-200:#E2E8F0;
      --success:#10B981;
      --info:#3B82F6;
      
      --font-display:'Crimson Pro',Georgia,serif;
      --font-body:'Work Sans',system-ui,sans-serif;
      --max-width:1200px;
      --radius:12px;
      --shadow:0 4px 12px rgba(10,25,41,0.08);
      --shadow-lg:0 12px 32px rgba(10,25,41,0.12);
    }

    *{margin:0;padding:0;box-sizing:border-box}

    body{
      font-family:var(--font-body);
      background:var(--cream);
      color:var(--navy);
      line-height:1.6;
    }

    /* NAV */
    .navbar{
      background:white;
      border-bottom:1px solid var(--gray-200);
      padding:20px 0;
      box-shadow:var(--shadow);
    }

    .nav-container{
      max-width:var(--max-width);
      margin:0 auto;
      padding:0 32px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .brand{
      font-family:var(--font-display);
      font-size:24px;
      font-weight:700;
      color:var(--navy);
      text-decoration:none;
    }

    .brand span{color:var(--gold)}

    .nav-links{
      display:flex;
      gap:24px;
      align-items:center;
    }

    .nav-link{
      color:var(--slate);
      text-decoration:none;
      font-weight:600;
      font-size:14px;
      transition:color 0.2s;
    }

    .nav-link:hover{color:var(--navy)}
    .nav-link.active{color:var(--gold)}

    /* CONTAINER */
    .container{
      max-width:var(--max-width);
      margin:0 auto;
      padding:60px 32px;
    }

    /* HEADER */
    .page-header{
      margin-bottom:48px;
    }

    .breadcrumb{
      display:flex;
      align-items:center;
      gap:8px;
      font-size:14px;
      color:var(--slate);
      margin-bottom:16px;
    }

    .breadcrumb a{
      color:var(--slate);
      text-decoration:none;
    }

    .breadcrumb a:hover{color:var(--gold)}

    .page-title{
      font-family:var(--font-display);
      font-size:48px;
      font-weight:700;
      color:var(--navy);
      margin-bottom:12px;
    }

    .page-subtitle{
      font-size:18px;
      color:var(--slate);
      max-width:700px;
    }

    /* STATS */
    .stats-bar{
      display:flex;
      gap:32px;
      background:white;
      padding:24px 32px;
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      margin-bottom:40px;
    }

    .stat{
      display:flex;
      flex-direction:column;
    }

    .stat-value{
      font-family:var(--font-display);
      font-size:32px;
      font-weight:700;
      color:var(--gold);
      line-height:1;
      margin-bottom:6px;
    }

    .stat-label{
      font-size:13px;
      color:var(--slate);
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:0.5px;
    }

    /* REPORTS GRID */
    .reports-grid{
      display:grid;
      gap:24px;
    }

    .report-card{
      background:white;
      border:1px solid var(--gray-200);
      border-radius:var(--radius);
      overflow:hidden;
      transition:all 0.3s;
      box-shadow:var(--shadow);
    }

    .report-card:hover{
      transform:translateY(-4px);
      box-shadow:var(--shadow-lg);
      border-color:var(--gold);
    }

    .report-header{
      background:linear-gradient(135deg,var(--navy),var(--navy-light));
      padding:28px 32px;
      border-bottom:3px solid var(--gold);
      position:relative;
    }

    .report-type{
      font-size:11px;
      font-weight:700;
      color:var(--gold-light);
      text-transform:uppercase;
      letter-spacing:1px;
      margin-bottom:10px;
    }

    .report-title{
      font-family:var(--font-display);
      font-size:26px;
      font-weight:700;
      color:white;
      margin-bottom:10px;
      line-height:1.3;
    }

    .report-meta{
      display:flex;
      gap:20px;
      font-size:14px;
      color:rgba(255,255,255,0.7);
    }

    .report-meta-item{
      display:flex;
      align-items:center;
      gap:6px;
    }

    .report-body{
      padding:32px;
    }

    .report-details{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:24px;
      margin-bottom:28px;
    }

    .detail-item{
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    .detail-label{
      font-size:12px;
      font-weight:700;
      color:var(--slate);
      text-transform:uppercase;
      letter-spacing:0.5px;
    }

    .detail-value{
      font-size:15px;
      font-weight:600;
      color:var(--navy);
    }

    .report-actions{
      display:flex;
      gap:12px;
      padding-top:24px;
      border-top:1px solid var(--gray-100);
    }

    .btn{
      padding:12px 24px;
      border-radius:var(--radius);
      font-weight:700;
      font-size:14px;
      cursor:pointer;
      transition:all 0.3s;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
      border:none;
    }

    .btn-primary{
      background:var(--gold);
      color:var(--navy);
      box-shadow:0 4px 12px rgba(201,166,71,0.3);
    }

    .btn-primary:hover{
      background:var(--gold-light);
      transform:translateY(-2px);
      box-shadow:0 6px 16px rgba(201,166,71,0.4);
    }

    .btn-secondary{
      background:var(--navy);
      color:white;
    }

    .btn-secondary:hover{
      background:var(--navy-light);
    }

    .btn-outline{
      background:transparent;
      border:2px solid var(--gray-200);
      color:var(--slate);
    }

    .btn-outline:hover{
      border-color:var(--gold);
      color:var(--gold);
    }

    /* EMPTY STATE */
    .empty-state{
      text-align:center;
      padding:80px 32px;
      background:white;
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }

    .empty-icon{
      font-size:72px;
      margin-bottom:24px;
      opacity:0.3;
    }

    .empty-title{
      font-family:var(--font-display);
      font-size:32px;
      font-weight:700;
      color:var(--navy);
      margin-bottom:16px;
    }

    .empty-text{
      font-size:16px;
      color:var(--slate);
      max-width:500px;
      margin:0 auto 32px;
      line-height:1.7;
    }

    /* RESPONSIVE */
    @media(max-width:768px){
      .page-title{font-size:36px}
      .stats-bar{flex-direction:column;gap:20px}
      .report-details{grid-template-columns:1fr}
      .report-actions{flex-direction:column}
      .nav-links{display:none}
    }
  </style>
</head>

<body>

<!-- NAV -->
<nav class="navbar">
  <div class="nav-container">
    <a href="/lms" class="brand">CRIPF<span>Cnt</span></a>
    <div class="nav-links">
      <a href="/scoi" class="nav-link">Marketplace</a>
      <a href="/scoi/purchased" class="nav-link active">My Audits</a>
      {{#if user}}
        <a href="/parent/dashboard" class="nav-link">Dashboard</a>
      {{/if}}
    </div>
  </div>
</nav>

<!-- MAIN -->
<main class="container">
  
  <!-- HEADER -->
  <div class="page-header">
    <div class="breadcrumb">
      <a href="/scoi">Marketplace</a>
      <span>‚Üí</span>
      <span>My Purchased Reports</span>
    </div>

    <h1 class="page-title">My Intelligence Reports</h1>
    <p class="page-subtitle">
      Lifetime access to your purchased SCOI audits. View, download, or print at any time.
    </p>
  </div>

  <!-- STATS -->
  {{#if purchases.length}}
    <div class="stats-bar">
      <div class="stat">
        <div class="stat-value">{{purchases.length}}</div>
        <div class="stat-label">Total Reports</div>
      </div>
      <div class="stat">
        <div class="stat-value">‚ôæÔ∏è</div>
        <div class="stat-label">Lifetime Access</div>
      </div>
      <div class="stat">
        <div class="stat-value">‚úì</div>
        <div class="stat-label">Full Rights</div>
      </div>
    </div>
  {{/if}}

  <!-- REPORTS -->
  {{#if purchases.length}}
    <div class="reports-grid">
      {{#each purchases}}
        <article class="report-card">
          
          <div class="report-header">
            <div class="report-type">
              {{#if (eq this.auditId.auditClass "special_report")}}
                Special SCOI Report
              {{else}}
                Placement Audit
              {{/if}}
            </div>

            <h2 class="report-title">{{this.auditId.subject.name}}</h2>

            <div class="report-meta">
              <div class="report-meta-item">
                <span>üìÖ</span>
                <span>{{this.auditId.assessmentWindow.label}}</span>
              </div>
              <div class="report-meta-item">
                <span>‚úì</span>
                <span>Purchased {{formatDate this.createdAt}}</span>
              </div>
            </div>
          </div>

          <div class="report-body">
            
            <div class="report-details">
              <div class="detail-item">
                <div class="detail-label">Framework</div>
                <div class="detail-value">{{this.auditId.framework}}</div>
              </div>

              <div class="detail-item">
                <div class="detail-label">Author</div>
                <div class="detail-value">{{this.auditId.author}}</div>
              </div>

              <div class="detail-item">
                <div class="detail-label">Price Paid</div>
                <div class="detail-value">${{math this.pricePaid "/" 100}}</div>
              </div>
            </div>

            <div class="report-actions">
              <a 
                href="/scoi/audits/{{this.auditId._id}}/view" 
                target="_blank"
                class="btn btn-primary"
              >
                üëÅÔ∏è View Report
              </a>

              <a 
                href="/scoi/audits/{{this.auditId._id}}/download" 
                class="btn btn-secondary"
              >
                üì• Download PDF
              </a>

              <button 
                onclick="window.open('/scoi/audits/{{this.auditId._id}}/view','_blank').print()"
                class="btn btn-outline"
              >
                üñ®Ô∏è Print
              </button>
            </div>

          </div>
        </article>
      {{/each}}
    </div>

  {{else}}
    
    <!-- EMPTY STATE -->
    <div class="empty-state">
      <div class="empty-icon">üìä</div>
      <h2 class="empty-title">No Reports Yet</h2>
      <p class="empty-text">
        You haven't purchased any SCOI intelligence reports yet. Browse the marketplace 
        to access civilization-grade structural audits authored by Donald Mataranyika.
      </p>
      <a href="/scoi" class="btn btn-primary">
        Browse Marketplace ‚Üí
      </a>
    </div>

  {{/if}}

</main>

</body>
</html>
